<!-- BEGIN PATCH: settings global centralisés -->
<section class="card">
  <h2>Paramètres globaux</h2>
  <p class="muted">Tous les paramètres modules sont centralisés ici.</p>
</section>

<section class="card" id="settings-reception">
  <button type="button" data-accordion-trigger aria-controls="settingsReceptionPanel" aria-expanded="true">Réception / Réception conteneur</button>
  <div id="settingsReceptionPanel">
    <p class="muted">Clés: DLWMS_BINMAP, DLWMS_CONTAINER_DRAFT_V1, DLWMS_CONTAINER_HISTORY_V1.</p>
    <label for="receptionImportPref">Préférence import</label>
    <input id="receptionImportPref" placeholder="csv_priority" />
  </div>
</section>

<section class="card" id="settings-consolidation">
  <button type="button" data-accordion-trigger aria-controls="settingsConsolidationPanel" aria-expanded="false">Consolidation</button>
  <div id="settingsConsolidationPanel" hidden>
    <p class="muted">Règles de consolidation et exports.</p>
  </div>
</section>

<section class="card" id="settings-remise">
  <button type="button" data-accordion-trigger aria-controls="settingsRemisePanel" aria-expanded="false">Remise</button>
  <div id="settingsRemisePanel" hidden>
    <p class="muted">Overrides utilisateurs et préférences remise.</p>
  </div>
</section>

<section class="card" id="settings-layout">
  <button type="button" data-accordion-trigger aria-controls="settingsLayoutPanel" aria-expanded="false">Layout</button>
  <div id="settingsLayoutPanel" hidden>
    <p class="muted">Options grille et types de cases.</p>
    <div class="row">
      <label><input type="checkbox" id="settingsLayoutDragPaint" /> Drag paint</label>
      <label>Taille pinceau<select id="settingsLayoutBrush"><option>1x1</option><option>2x2</option><option>3x3</option></select></label>
      <label><input type="checkbox" id="settingsLayoutCoords" /> Show coords</label>
      <label><input type="checkbox" id="settingsLayoutAutosave" /> Autosave</label>
      <label>Favoris palette<input id="settingsLayoutFavorites" placeholder="rack,aisle,dock" /></label>
    </div>
  </div>
</section>

<section class="card" id="settings-ai-memory">
  <button type="button" data-accordion-trigger aria-controls="settingsAiMemoryPanel" aria-expanded="false">IA · Mémoire / Entraînement</button>
  <div id="settingsAiMemoryPanel" hidden>
    <p class="muted">Toute la mémoire d'entraînement IA est centralisée ici.</p>
    <label for="aiMemoryZone">Mémoire IA (JSON)</label>
    <textarea id="aiMemoryZone" rows="10" class="input" placeholder='{"history":[]}'></textarea>
    <div class="row">
      <button id="saveAiMemory" class="btn btn-primary" type="button">Sauvegarder</button>
      <button id="clearAiMemory" class="btn" type="button">Réinitialiser</button>
    </div>
  </div>
</section>

<section class="card" id="settings-storage-faq">
  <h2>Storage · Règles & FAQ</h2>
  <div class="row" role="tablist" aria-label="Onglets stockage">
    <button type="button" id="settingsStorageTab" class="btn" data-settings-storage-tab="rules" aria-selected="true">Storage règles</button>
    <button type="button" id="settingsFaqTab" class="btn" data-settings-storage-tab="faq" aria-selected="false">FAQ</button>
  </div>

  <div id="settingsStorageRulesPanel" data-settings-storage-panel="rules">
    <p class="muted">Informations de règles sauvegardées dans le storage local.</p>
    <div class="row" style="justify-content:space-between;align-items:center;gap:8px;">
      <div id="settingsStorageReadMeta" class="muted">Dernière lecture du storage: —</div>
      <div class="row" style="gap:8px;">
        <button type="button" id="settingsStorageRefreshBtn" class="btn">Rafraîchir</button>
        <button type="button" id="settingsStorageCopyBtn" class="btn">Copier diagnostic storage</button>
      </div>
    </div>
    <div id="settingsRulebookValidation" class="input" style="margin-top:8px;"></div>
    <div id="settingsRulebookDiff" class="input" style="margin-top:8px;"></div>
    <div class="row" style="margin-top:8px;gap:8px;">
      <span class="muted">Filtres clés localStorage:</span>
      <button type="button" id="settingsStorageFilterAll" class="btn btn-primary">Toutes</button>
      <button type="button" id="settingsStorageFilterDlwms" class="btn">DLWMS_</button>
      <button type="button" id="settingsStorageFilterRule" class="btn">rule</button>
      <button type="button" id="settingsStorageFilterFaq" class="btn">faq</button>
    </div>
    <div id="settingsStorageKeysList" class="input" style="margin-top:8px;max-height:160px;overflow:auto;"></div>
    <div class="row" style="margin-top:8px;gap:8px;">
      <button type="button" id="settingsAdminToggleBtn" class="btn">Activer mode admin</button>
      <span id="settingsAdminStatus" class="muted">Mode admin désactivé</span>
    </div>
    <pre id="settingsRulesStorageDump" class="input" style="white-space:pre-wrap;max-height:280px;overflow:auto;">Chargement...</pre>
  </div>

  <div id="settingsStorageFaqPanel" data-settings-storage-panel="faq" hidden>
    <p class="muted">FAQ disponibles dans l'application (sources locale + référentiel).</p>
    <div id="settingsFaqCounters" class="row" style="gap:6px;flex-wrap:wrap;margin-bottom:8px;"></div>
    <div class="row" style="gap:8px;align-items:center;">
      <input id="settingsFaqSearchInput" class="input" style="flex:1;" placeholder="Recherche texte FAQ" />
      <select id="settingsFaqCategoryFilter" class="input" style="max-width:220px;"></select>
      <button type="button" id="settingsFaqExportJson" class="btn">Export JSON</button>
      <button type="button" id="settingsFaqExportCsv" class="btn">Export CSV</button>
    </div>
    <div id="settingsFaqPagination" class="row" style="justify-content:space-between;align-items:center;margin:8px 0;"></div>
    <div id="settingsFaqInventory" class="input" style="max-height:280px;overflow:auto;"></div>
  </div>
</section>


<section class="card" id="settings-runtime-pack50">
  <h2>Pack 50 · Runtime / Santé système</h2>
  <p class="muted">Configuration runtime multi-environnements, feature flags, queue offline et diagnostics rapides.</p>
  <div class="row" style="gap:10px;flex-wrap:wrap;">
    <span class="btn">Version: <strong id="settingsAppVersion">—</strong></span>
    <span class="btn">Build: <strong id="settingsBuildDate">—</strong></span>
    <span class="btn">Backend: <strong id="settingsBackendStatus">—</strong></span>
    <span class="btn">Queue: <strong id="settingsQueueDepth">0</strong></span>
  </div>
  <p class="muted">Heure source: <span id="settingsServerTime">—</span></p>
  <div id="settingsFeatureFlags" class="row" style="gap:10px;flex-wrap:wrap;"></div>
  <div class="row" style="gap:8px;flex-wrap:wrap;">
    <button type="button" id="settingsRuntimeRefresh" class="btn">Rafraîchir santé</button>
    <button type="button" id="settingsSyncNow" class="btn btn-primary">Sync maintenant</button>
    <button type="button" id="settingsExportDiagnostics" class="btn">Exporter diagnostic</button>
    <button type="button" id="settingsClearQueue" class="btn">Nettoyage sécurisé (queue)</button>
  </div>
</section>

<section class="card" id="settings-azure-openai-link">
  <h2>IA Cloud · Azure OpenAI (frontend)</h2>
  <p class="muted">Liaison optionnelle côté frontend. La clé API reste stockée localement dans ce navigateur.</p>
  <p class="muted">Pour un mode production sécurisé, passer par un backend proxy au lieu d'exposer la clé côté client.</p>
  <div class="row" style="gap:8px;flex-wrap:wrap;align-items:center;">
    <a class="btn" href="https://oai.azure.com/" target="_blank" rel="noopener noreferrer">Ouvrir Azure AI Foundry</a>
    <a class="btn" href="https://learn.microsoft.com/azure/ai-services/openai/reference" target="_blank" rel="noopener noreferrer">Doc API Azure OpenAI</a>
  </div>
  <div class="stack" style="margin-top:10px;gap:8px;">
    <label for="settingsAzureEndpoint">Endpoint Azure (ex: https://mon-instance.openai.azure.com)</label>
    <input id="settingsAzureEndpoint" class="input" placeholder="https://mon-instance.openai.azure.com" />
    <label for="settingsAzureDeployment">Deployment</label>
    <input id="settingsAzureDeployment" class="input" placeholder="gpt-4o-mini" />
    <label for="settingsAzureApiVersion">API version</label>
    <input id="settingsAzureApiVersion" class="input" placeholder="2024-10-21" />
    <label for="settingsAzureApiKey">API key</label>
    <input id="settingsAzureApiKey" class="input" type="password" autocomplete="off" placeholder="********" />
  </div>
  <div class="row" style="margin-top:10px;gap:8px;flex-wrap:wrap;">
    <button type="button" id="settingsAzureSave" class="btn btn-primary">Sauvegarder liaison</button>
    <button type="button" id="settingsAzureTest" class="btn">Tester Azure OpenAI</button>
  </div>
  <p class="muted" id="settingsAzureStatus">Statut: non testé</p>
</section>

<section class="card" id="settings-diagnostics">
  <h2>Diagnostics runtime (mode debug)</h2>
  <p class="muted">Désactivé par défaut. Affiche version app, build, taille storage, dernier import et erreurs récentes.</p>
  <div class="row" style="gap:8px;align-items:center;">
    <label><input type="checkbox" id="settingsDiagnosticsToggle" /> Activer Diagnostics</label>
    <button type="button" id="settingsDiagnosticsRefresh" class="btn">Rafraîchir</button>
    <button type="button" id="settingsDiagnosticsCopy" class="btn">Copier</button>
    <button type="button" id="settingsDiagnosticsExportLogs" class="btn">Exporter logs JSON</button>
  </div>
  <pre id="settingsDiagnosticsPanel" class="input" hidden style="white-space:pre-wrap;max-height:260px;overflow:auto;"></pre>
</section>

<!-- END PATCH: settings global centralisés -->
